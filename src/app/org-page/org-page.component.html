<p-toast position="bottom-center" class="ui-messages-error"></p-toast>
<p-dialog header="New Section Creation" [(visible)]="showNewSectionPopup">
  <div [hidden]="!viewWiki">
    <div style="width: 300px;" >
      <p>Section Title</p>
      <input type="text" pInputText [(ngModel)]="newSectionName"/>
      <p style="margin-top: 20px;">Section Text</p>
      <p-editor [(ngModel)]="newSectionText" [style]="{'height': '200px'}">
        <p-header>
            <span class="ql-formats">
                <button class="ql-bold" aria-label="Bold"></button>
                <button class="ql-italic" aria-label="Italic"></button>
                <button class="ql-underline" aria-label="Underline"></button>
            </span>
        </p-header>
      </p-editor>
    </div>
    <div class="p-grid" style="text-align: center; padding-top: 10px">
      <p-button class="p-col-6" (onClick)="showNewSectionPopup = false" label="Cancel"></p-button>
      <p-button class="p-col-6" (onClick)="submitNewSection()" label ="Submit"></p-button>
    </div>
  </div>
  <div style="width: 300px;" [hidden]="!viewTeams">
    <p>New Team Name</p>
    <input type="text" pInputText [(ngModel)]="newTeamName"/>
    <p style="margin-top: 10px">New Team Members</p>
    <form #formRef="ngForm">
      <div *ngFor="let member of members; let i = index" class="col-sm-3">
        <div class="form-group">
          <input pInputText type="text" [(ngModel)]="members[i].value" name="name{{i}}" class="form-control" #name="ngModel" required />
        </div>
        <br />
      </div>
      <p-button [disabled]="!formRef.form.valid" (click)="addAnotherMember()" label="Add another member"></p-button>
    </form>
    <div class="p-grid" style="text-align: center; padding-top: 10px">
      <p-button class="p-col-6" (onClick)="showNewSectionPopup = false" label="Cancel"></p-button>
      <p-button class="p-col-6" (onClick)="submitNewTeam()" label ="Submit"></p-button>
    </div>

  </div>
  <div style="width: 300px;" [hidden]="!viewTrips">
    <p>Country of Trip</p>
    <input type="text" pInputText [(ngModel)]="newTripCountry"/>
    <p style="margin-top: 10px">Site of Trip</p>
    <input type="text" pInputText [(ngModel)]="newTripSite"/>
    <p style="margin-top: 10px">Team on Trip</p>
    <input type="text" pInputText [(ngModel)]="newTripTeam"/>
    <div class="p-grid" style="text-align: center; padding-top: 10px">
      <p-button class="p-col-6" (onClick)="showNewSectionPopup = false" label="Cancel"></p-button>
      <p-button class="p-col-6" (onClick)="submitNewTrip()" label ="Submit"></p-button>
    </div>

  </div>
</p-dialog>


<div id="mainBody" [ngStyle]="{'margin-bottom' : footerHeight + 10 + 'px'}" >


  <!--<div [hidden]="!viewWiki" style="width: 100vw">-->
    <!--<a (click)="editMode = !editMode" style="font-size: smaller" [hidden]="!canEdit">Toggle Edit Mode</a>-->
    <!--<div *ngFor="let info of sections; let i = index" style="margin-top: 20px; padding-right: 35px">-->
      <!--<div [hidden]="!hideme[i]">-->
        <!--<p-editor type="text" [(ngModel)]= "editText[i]" [style]="{'height':'320px'}" ></p-editor>-->
        <!--<div class="p-grid" style="text-align: center">-->
          <!--<p-button class="p-col-6" (onClick)="hideme[i] = !hideme[i]">Cancel</p-button>-->
          <!--<p-button class="p-col-6" (click)="submitWikiEdit(info.title, i)">Submit</p-button>-->
        <!--</div>-->
      <!--</div>-->
      <!--<p-fieldset legend={{info.title}} [toggleable]="true" [hidden]="hideme[i]">-->
        <!--<markdown [data]="info.markup"></markdown>-->
      <!--</p-fieldset>-->
      <!--<div [hidden]="!editMode">-->
        <!--<a (click)="hideme[i] = !hideme[i]" style="font-size: smaller" [hidden]="hideme[i]">edit?</a>-->
      <!--</div>-->
    <!--</div>-->
    <!--&lt;!&ndash;<a (click)="submitNewWikiEdit(editHeaderText, editText.length)" style="font-size: smaller" [hidden]="!editMode">Add new thing</a>&ndash;&gt;-->
  <!--</div>-->
  <div [hidden]="!viewWiki" style="width: 100vw">
    <div *ngFor="let info of sections; let i = index" style="margin-top: 20px; padding-right: 35px">
      <div [hidden]="!hideme[i]">
        <p-editor type="text" [(ngModel)]= "editText[i]" [style]="{'height':'320px'}" ></p-editor>
        <div class="p-grid" style="text-align: center; padding-top: 5px">
          <p-button class="p-col-6" (onClick)="hideme[i] = !hideme[i];" label="Cancel"></p-button>
          <p-button class="p-col-6" (click)="submitWikiEdit(info.title, i)" label="Submit"></p-button>
        </div>
      </div>
      <p-fieldset [toggleable]="true" [hidden]="hideme[i]">
        <p-header>
          {{info.title}}
          <div [style.display]="!editMode ? 'none' : 'inline-block'">
            <i class="pi pi-pencil" style="cursor: pointer; padding-left: 10px" (click)="hideme[i] = !hideme[i]"></i>
          </div>
        </p-header>
        <markdown [data]="info.markup"></markdown>
      </p-fieldset>
    </div>
    <!--<a (click)="submitEdit('test111', editText.length)" style="font-size: smaller" [hidden]="!editMode">Add new thing</a>-->
    <!--<div *ngFor="let g of groups; let i = index" style="margin-top: 20px; padding-right: 35px">-->
      <!--<a routerLink="./group/{{g.id}}" ><p class="p-col p-col-2">{{g.name}}</p></a>-->
    <!--</div>-->
  </div>

  <div [hidden]="!viewTeams">
    <h3>Teams</h3>
    <p-accordion [multiple]="false">
      <p-accordionTab *ngFor="let team of teams" [header]="(team | async)?.name">
      </p-accordionTab>
    </p-accordion>
    <!--Show create team button if they are admin-->

  </div>

  <div [hidden]="!viewTrips">
    <h3>Trips</h3>
    <span id="listContainer"  style="height: 100%; width: 100%">
      <p-listbox [options]="trips" optionLabel="tripName" [style] = "{'width':'100%'}" [(ngModel)]="selectedTrip"
               (click)="tripClick()">
      </p-listbox>
    </span>
  </div>
</div>


<!-- <div id ="footer"  class="p-grid" [ngStyle]="{'height' : footerHeight + 'px'}" style="text-align: center; bottom: 0; position: fixed; width: 100%">
  <div class="p-col-4" [ngStyle]="{'background-color' : viewWiki ? 'blue' : 'aqua' }">
    <a (click)="viewWiki = true; viewTeams = false; viewTrips = false;"><p style="height: 100%" >Wiki</p></a>
  </div>
  <div class="p-col-4" [ngStyle]="{'background-color' : viewTeams ? 'blue' : 'aqua' }">
    <a (click)="viewWiki= false; viewTeams = true; viewTrips = false;"><p style="height: 100%" >Teams</p></a>
  </div>
  <div class="p-col-4" [ngStyle]="{'background-color' : viewTrips ? 'blue' : 'aqua' }">
    <a (click)="viewWiki= false; viewTeams = false; viewTrips = true;"><p style="height: 100%" >Trips</p></a>
  </div>
</div>
 -->
<p-toolbar [style]="{'background': 'none', 'padding': '0', 'border': 'none', 'position': 'fixed', 'bottom': '0', 'left': '0', 'width': '100%', 'height': '50px'}">
    <button class="footer-button" pButton type="button"
      style="height: 100%; border: none; border-radius: 0"
      [ngStyle]="{'width': 100/3 + '%'}"
      (click)="viewWiki = true; viewTeams = false; viewTrips = false; sharedService.addName.emit('New Section');
          sharedService.canEdit.emit(editMode);">
      <i class="pi pi-align-justify" [ngStyle]="{'opacity': !viewWiki ? '0.5' : '1'}"></i>
      <div [ngStyle]="{'opacity': !viewWiki ? '0.5' : '1'}">
        <span>Wiki</span>
      </div>
    </button>
    <button class="footer-button" pButton type="button"
      style="height: 100%; border: none; border-radius: 0"
      [ngStyle]="{'width': 100/3 + '%'}"
      (click)="viewWiki = false; viewTeams = true; viewTrips = false; sharedService.addName.emit('New Team');
        sharedService.canEdit.emit(canEditTeams);">
      <i class="pi pi-users" [ngStyle]="{'opacity': !viewTeams ? '0.5' : '1'}"></i>
      <div [ngStyle]="{'opacity': !viewTeams ? '0.5' : '1'}">
        <span>Teams</span>
      </div>
    </button>
    <button class="footer-button" pButton type="button"
      style="height: 100%; border: none; border-radius: 0"
      [ngStyle]="{'width': 100/3 + '%'}"
      (click)="viewWiki = false; viewTeams = false; viewTrips = true; sharedService.addName.emit('New Trip');
        sharedService.canEdit.emit(canEditTrips);">
      <i class="pi pi-briefcase" [ngStyle]="{'opacity': !viewTrips ? '0.5' : '1'}"></i>
      <div [ngStyle]="{'opacity': !viewTrips ? '0.5' : '1'}">
        <span>Trips</span>
      </div>
    </button>
  </p-toolbar>
